<html>
<head>
    
</head>
<body>
<input type="text" id="user" size="30" /><br />
<textarea id="messages" rows="8" cols="40" readonly></textarea><br />
<input type="text" id="msg" size="50"/>

<script type="text/javascript" src="jquery-1.7.min.js"></script>
<script type="text/javascript" src="jquery-ui-1.8.custom.min.js"></script>
<script type="text/javascript" src="vertxbus.js"></script>
<script type="text/javascript" src="sockjs-0.2.1.min.js"></script>

<script type="text/javascript">

var eb = new vertx.EventBus('http://localhost:8081/eventbus');
var user;

$(function () {
    eb.onopen = function () {
        var handler = function (obj) {
            $('#messages').append(obj.message);
        }
        
        eb.registerHandler('goja.chat', handler);
    }
});

$('#msg').keypress(function (event) {
    if(event.keyCode == 13) {
        var obj = {message: user + ': ' + $('#msg').val() + '<br>'}
        eb.send('goja.chat', obj);
        $('#msg').val('');
    }
});

$('#user').change(function () {
    user = $('#user').val();
});

</script>   
</body>
</html>